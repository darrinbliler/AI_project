knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/darri/OneDrive/Documents/Career/Grad Programs/UWT MSBA/TBANLT 540/Final Project/Spotify"))
library(tidyverse)
library(readxl)
library(mi)
library(stringr)
library(moments)
songdata <- read_csv("data.csv")
summary(songdata)
hist(songdata$danceability)
hist(songdata$acousticness)
hist(songdata$energy)
hist(songdata$duration_ms)
hist(songdata$energy)
hist(songdata$duration_ms)
hist(songdata$duration_ms)
hist(songdata$instrumentalness)
hist(songdata$valence)
hist(songdata$popularity)
hist(songdata$tempo)
hist(songdata$liveness)
hist(songdata$loudness)
hist(songdata$danceability)
hist(songdata$acousticness)
hist(songdata$energy)
hist(songdata$duration_ms)
hist(songdata$instrumentalness)
hist(songdata$valence)
hist(songdata$popularity)
hist(songdata$tempo)
hist(songdata$liveness)
hist(songdata$loudness)
hist(songdata$speechiness)
hist(songdata$year)
hist(songdata$mode)
boxplot(songdata$mode)
boxplot.default(songdata$mode,)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/darri/OneDrive - UW/UWT MSBA/TBANLT 540/Canvas Module 2"))
library(ggplot2)
library(ggplot2)
ggplot(songdata$mode)+geom_boxplot()
ggplot(songdata$mode)+geom_col()
hist(songdata$mode)
hist(songdata$explicit)
hist(songdata$key)
hist(songdata$year)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
songdata2<- select(songdata,acousticness,danceability,duration_ms,energy,explicit,liveness,loudness,mode,speechiness,tempo,valence)
skew <- skewness(songdata2)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
kurt <- kurtosis(songdata2)
show(skew)
show(skew)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
#rownames(datashape)<-column_names
datashape$skew <- unname(skew)
#rownames(datashape)<-column_names
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
hist(duration_ms.ln)
plot(duration_ms.ln)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
plot(duration_ms.ln)
plot(songdata2$duration_ms.ln)
hist(songdata$duration_ms)
hist(songdata2$duration_ms.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
plot(songdata2$speechiness.ln)
hist(songdata2$speechiness.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
hist(songdata2$speechiness.ln)
hist(songdata2$speechiness.ln)
songdata2$liveness.ln <- log(songdata2$liveness)
songdata2$speechiness.ln <- log(songdata2$speechiness)
hist(songdata2$speechiness.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
hist(songdata2$speechiness.ln)
hist(songdata2$liveness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
skew <- skewness(songdata2)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$liveness.ln <- log(songdata2$liveness+1)
hist(songdata2$liveness.ln)
skew <- skewness(songdata2)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
hist(songdata$instrumentalness)
songdata2<- select(songdata,acousticness,danceability,duration_ms,energy,explicit,liveness,loudness,mode,speechiness,tempo,valence,instrumentalness)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
show(skew)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
#rownames(datashape)<-column_names
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness + 1)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
plot(songdata2$duration_ms.ln)
plot(songdata2$duration_ms.ln)
hist(songdata2$duration_ms.ln)
hist(songdata2$duration_ms.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
hist(songdata2$speechiness.ln)
songdata2$liveness.ln <- log(songdata2$liveness+1)
hist(songdata2$liveness.ln)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness + 1)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
hist(songdata2$instrumentalness.ln)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness + 1)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
datashape<-data.frame(row.names=row_names)
.datashape$skew <- unname(skew)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2<- select(songdata,acousticness,danceability,duration_ms,energy,explicit,liveness,loudness,mode,speechiness,tempo,valence,instrumentalness,year)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
show(skew)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
#rownames(datashape)<-column_names
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
hist(songdata$year)
songdata2$year.pwr <- pwr(songdata2$year)
songdata2$year.pwr <- power(songdata2$year)
songdata2$year.pwr <- exp(songdata2$year)
hist(songdata$year)
hist(songdata$year.pwr)
hist(songdata$year.pwr)
songdata2$year.pwr <- log(songdata2$year)
hist(songdata$year.pwr)
songdata2$year.pwr <- log(songdata2$year+1)
hist(songdata$year.pwr)
songdata2$year.pwr <- log(songdata2$year)
hist(songdata$year.pwr)
View(songdata2$year.pwr)
sum(is.na(songdata2$year.pwr))
sum(is.infinite(songdata2$year.pwr))
songdata2$year.ln <- log(songdata2$year)
hist(songdata2$year.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
plot(songdata2$duration_ms.ln)
hist(songdata2$duration_ms.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
hist(songdata2$speechiness.ln)
songdata2$liveness.ln <- log(songdata2$liveness+1)
hist(songdata2$liveness.ln)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness + 1)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence, data= songdata2)
summary(song.fit)
plot(song.fit)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln, data= songdata2)
summary(song.fit)
plot(song.fit)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln, data= songdata2)
summary(song.fit)
plot(song.fit)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
plot(songdata2$duration_ms.ln)
hist(songdata2$duration_ms.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
hist(songdata2$speechiness.ln)
songdata2$liveness.ln <- log(songdata2$liveness+1)
hist(songdata2$liveness.ln)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness + 1)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln, data= songdata2)
summary(song.fit)
plot(song.fit)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/darri/OneDrive/Documents/Career/Grad Programs/UWT MSBA/TBANLT 540/Final Project/Spotify"))
library(tidyverse)
library(readxl)
library(mi)
library(stringr)
library(moments)
library(ggplot2)
songdata <- read_csv("data.csv")
summary(songdata)
hist(songdata$danceability)
hist(songdata$acousticness)
hist(songdata$energy)
hist(songdata$duration_ms)
hist(songdata$instrumentalness)
hist(songdata$valence)
hist(songdata$popularity)
hist(songdata$tempo)
hist(songdata$liveness)
hist(songdata$loudness)
hist(songdata$speechiness)
hist(songdata$year)
hist(songdata$mode)
hist(songdata$explicit)
hist(songdata$key)
hist(songdata$year)
songdata2<- select(songdata,acousticness,danceability,duration_ms,energy,explicit,liveness,loudness,mode,speechiness,tempo,valence,instrumentalness,year)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
show(skew)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
#rownames(datashape)<-column_names
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
plot(songdata2$duration_ms.ln)
hist(songdata2$duration_ms.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
hist(songdata2$speechiness.ln)
songdata2$liveness.ln <- log(songdata2$liveness+1)
hist(songdata2$liveness.ln)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness + 1)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln, data= songdata2)
summary(song.fit)
plot(song.fit)
song.residuals<-residuals(song.fit)
#plot(song.residuals)
ggplot(data=songdata2, aes(x=valence, y=song.residuals))+geom_point()+geom_smooth()
predict.model3 <- predict.lm(song.fit,songdata2)
ggplot(data=songdata2, aes(x=valence, y=danceability))+geom_point()+geom_point(aes(y=predict.model3),shape=1,color='red')+ggtitle(label="Actual Vs Predicted")
ggplot(data=songdata2, aes(x=acousticness, y=danceability))+geom_point()+geom_point(aes(y=predict.model3),shape=1,color='red')+ggtitle(label="Actual Vs Predicted")
ggplot(data=songdata2, aes(x=tempo, y=danceability))+geom_point()+geom_point(aes(y=predict.model3),shape=1,color='blue')+ggtitle(label="Actual Vs Predicted")
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln+songdata$mode+songdata$explicit+songdata$key, data= songdata2)
summary(song.fit)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln, data= songdata2)
summary(song.fit)
plot(song.fit)
plot(song.fit)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln, data= songdata2)
summary(song.fit)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln+songdata$mode+songdata$explicit+songdata$key, data= songdata2)
summary(song.fit)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/darri/OneDrive/Documents/Career/Grad Programs/UWT MSBA/TBANLT 540/Final Project/Spotify"))
library(tidyverse)
library(readxl)
library(mi)
library(stringr)
library(moments)
library(ggplot2)
songdata <- read_csv("data.csv")
summary(songdata)
hist(songdata$danceability)
hist(songdata$acousticness)
hist(songdata$energy)
hist(songdata$duration_ms)
hist(songdata$instrumentalness)
hist(songdata$valence)
hist(songdata$popularity)
hist(songdata$tempo)
hist(songdata$liveness)
hist(songdata$loudness)
hist(songdata$speechiness)
hist(songdata$year)
hist(songdata$mode)
hist(songdata$explicit)
hist(songdata$key)
hist(songdata$year)
songdata2<- select(songdata,acousticness,danceability,duration_ms,energy,explicit,liveness,loudness,mode,speechiness,tempo,valence,instrumentalness,year)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
show(skew)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
#rownames(datashape)<-column_names
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
songdata2$duration_ms.ln <- log(songdata2$duration_ms)
plot(songdata2$duration_ms.ln)
hist(songdata2$duration_ms.ln)
songdata2$speechiness.ln <- log(songdata2$speechiness+1)
hist(songdata2$speechiness.ln)
songdata2$liveness.ln <- log(songdata2$liveness+1)
hist(songdata2$liveness.ln)
songdata2$instrumentalness.ln <- log(songdata2$instrumentalness + 1)
hist(songdata2$instrumentalness.ln)
skew <- skewness(songdata2)
kurt <- kurtosis(songdata2)
row_names<-colnames(songdata2)
datashape<-data.frame(row.names=row_names)
datashape$skew <- unname(skew)
datashape$kurt <- unname(kurt)
show(datashape)
song.fit<-lm(formula = danceability ~ acousticness+duration_ms.ln+energy+explicit+liveness.ln+loudness+mode+speechiness.ln+tempo+valence+instrumentalness.ln+songdata$mode+songdata$explicit+songdata$key, data= songdata2)
summary(song.fit)
plot(song.fit)
song.residuals<-residuals(song.fit)
#plot(song.residuals)
ggplot(data=songdata2, aes(x=valence, y=song.residuals))+geom_point()+geom_smooth()
predict.model3 <- predict.lm(song.fit,songdata2)
ggplot(data=songdata2, aes(x=valence, y=danceability))+geom_point()+geom_point(aes(y=predict.model3),shape=1,color='red')+ggtitle(label="Actual Vs Predicted")
ggplot(data=songdata2, aes(x=acousticness, y=danceability))+geom_point()+geom_point(aes(y=predict.model3),shape=1,color='red')+ggtitle(label="Actual Vs Predicted")
ggplot(data=songdata2, aes(x=tempo, y=danceability))+geom_point()+geom_point(aes(y=predict.model3),shape=1,color='blue')+ggtitle(label="Actual Vs Predicted")
